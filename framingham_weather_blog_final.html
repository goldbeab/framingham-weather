<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Framingham Weather Forecast - Extreme Heat Alert</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 25px 45px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #ff6b6b 0%, #ffa500 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="3" fill="rgba(255,255,255,0.1)"/><circle cx="20" cy="20" r="2" fill="rgba(255,255,255,0.1)"/><circle cx="80" cy="30" r="1.5" fill="rgba(255,255,255,0.1)"/></svg>');
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 1;
        }

        .header .date {
            font-size: 1.2em;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .alert-banner {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            padding: 20px;
            text-align: center;
            font-weight: bold;
            font-size: 1.1em;
            border-left: 5px solid #fff;
            margin: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.3);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        .content {
            padding: 30px;
        }

        .highlight-section {
            background: linear-gradient(135deg, #2d3436 0%, #636e72 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(45, 52, 54, 0.3);
        }

        .highlight-section h2 {
            font-size: 1.8em;
            margin-bottom: 15px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
        }

        .forecast-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .day-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border-left: 4px solid #00b894;
        }

        .day-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }

        .day-card h3 {
            color: #2d3436;
            font-size: 1.4em;
            margin-bottom: 10px;
            border-bottom: 2px solid rgba(45, 52, 54, 0.2);
            padding-bottom: 8px;
        }

        .temp-range {
            font-size: 1.2em;
            font-weight: bold;
            color: #e17055;
            margin: 10px 0;
        }

        .weather-table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .weather-table th {
            background: linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .weather-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #f1f3f4;
            transition: background-color 0.3s ease;
        }

        .weather-table tr:hover td {
            background-color: #f8f9fc;
        }

        .weather-table tr:nth-child(even) td {
            background-color: #fdfdfe;
        }

        .temp-high {
            color: #e74c3c;
            font-weight: bold;
        }

        .temp-low {
            color: #3498db;
            font-weight: bold;
        }

        .wind-info {
            background: #fff3cd;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid #e17055;
            color: #856404;
        }

        .precipitation {
            background: #d1ecf1;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            color: #0c5460;
            border-left: 4px solid #17a2b8;
        }

        .top-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.95);
            margin: 0 20px;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            margin-top: -10px;
            margin-bottom: 20px;
        }

        .timestamp-compact {
            color: #495057;
            font-size: 0.9em;
        }

        .timestamp-label {
            font-weight: 600;
            margin-right: 8px;
        }

        .refresh-button-compact {
            background: linear-gradient(135deg, #00b894 0%, #00cec9 100%);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(0, 184, 148, 0.3);
        }

        .refresh-button-compact:hover {
            transform: translateY(-1px);
            box-shadow: 0 5px 15px rgba(0, 184, 148, 0.4);
        }

        .footer {
            background: linear-gradient(135deg, #636e72 0%, #2d3436 100%);
            color: white;
            padding: 20px;
            text-align: center;
            font-size: 0.9em;
        }

        .icon {
            display: inline-block;
            margin-right: 8px;
            font-size: 1.2em;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }
            
            .forecast-grid {
                grid-template-columns: 1fr;
            }
            
            .weather-table {
                font-size: 0.9em;
            }

            .top-controls {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üå°Ô∏è Framingham Weather Forecast</h1>
            <div class="date">Tuesday, June 24, 2025</div>
        </div>

        <div class="top-controls">
            <div class="timestamp-compact">
                <span class="timestamp-label">üìÖ Last Updated:</span>
                <span id="lastUpdated">Loading...</span>
            </div>
            <button class="refresh-button-compact" onclick="requestWeatherUpdate()">
                üîÑ Refresh Data
            </button>
        </div>

        <div class="alert-banner">
            üö® EXTREME HEAT WARNING IN EFFECT üö®<br>
            Heat Index Values up to 107¬∞F - Take Precautions!
        </div>

        <div class="content">
            <div class="highlight-section">
                <h2>üî• Next 12 Hours: Dangerous Heat Advisory</h2>
                <p>Framingham is experiencing its <strong>hottest day in nearly 3 years</strong> with temperatures soaring to potentially record-breaking levels. An Extreme Heat Warning is in effect through 8:00 PM today, with heat index values reaching a dangerous 107¬∞F.</p>
                
                <div class="wind-info">
                    <strong>üå¨Ô∏è Wind Conditions:</strong> West winds 8-11 mph providing minimal relief from the intense heat
                </div>
                
                <div class="precipitation">
                    <strong>‚òÄÔ∏è Sky Conditions:</strong> Sunny and clear with no chance of precipitation - no relief from cooling showers expected
                </div>
            </div>

            <div class="forecast-grid">
<!-- Forecast cards will be dynamically inserted here -->
</div>
                    <p><strong>Conditions:</strong> Sunny and dangerously hot</p>
                    <p><strong>Heat Index:</strong> Up to 107¬∞F</p>
                    <p><strong>Wind:</strong> West 8-11 mph</p>
                    <p><strong>Precipitation:</strong> 0%</p>
                </div>

                <div class="day-card">
                    <h3>Tomorrow - Wednesday, June 25</h3>
                    <div class="temp-range">High: <span class="temp-high">89¬∞F</span> | Low: <span class="temp-low">68¬∞F</span></div>
                    <p><strong>Conditions:</strong> Mostly sunny, much cooler</p>
                    <p><strong>Wind:</strong> Southwest 3-7 mph</p>
                    <p><strong>Precipitation:</strong> 10%</p>
                </div>

                <div class="day-card">
                    <h3>Thursday - June 26</h3>
                    <div class="temp-range">High: <span class="temp-high">78¬∞F</span> | Low: <span class="temp-low">62¬∞F</span></div>
                    <p><strong>Conditions:</strong> Partly cloudy with possible showers</p>
                    <p><strong>Wind:</strong> East-Northeast 5-10 mph</p>
                    <p><strong>Precipitation:</strong> 60%</p>
                </div>
            </div>

            <h2 style="color: #2d3436; margin: 30px 0 20px 0; font-size: 1.8em;">üìä Detailed Weather Data</h2>
            
            <table class="weather-table">
                <thead>
                    <tr>
                        <th>Weather Type</th>
                        <th>Today (Jun 24)</th>
                        <th>Tomorrow (Jun 25)</th>
                        <th>Thursday (Jun 26)</th>
                        <th>Friday (Jun 27)</th>
                        <th>Saturday (Jun 28)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>High Temperature</strong></td>
                        <td class="temp-high">102¬∞F</td>
                        <td>89¬∞F</td>
                        <td>78¬∞F</td>
                        <td>82¬∞F</td>
                        <td>85¬∞F</td>
                    </tr>
                    <tr>
                        <td><strong>Low Temperature</strong></td>
                        <td class="temp-low">79¬∞F</td>
                        <td class="temp-low">68¬∞F</td>
                        <td class="temp-low">62¬∞F</td>
                        <td class="temp-low">65¬∞F</td>
                        <td class="temp-low">70¬∞F</td>
                    </tr>
                    <tr>
                        <td><strong>Real Feel (Heat Index)</strong></td>
                        <td class="temp-high">Up to 107¬∞F</td>
                        <td>92¬∞F</td>
                        <td>78¬∞F</td>
                        <td>84¬∞F</td>
                        <td>88¬∞F</td>
                    </tr>
                    <tr>
                        <td><strong>Dew Point</strong></td>
                        <td>68¬∞F (Humid)</td>
                        <td>65¬∞F (Comfortable)</td>
                        <td>58¬∞F (Comfortable)</td>
                        <td>62¬∞F (Comfortable)</td>
                        <td>66¬∞F (Comfortable)</td>
                    </tr>
                    <tr>
                        <td><strong>Wind Speed</strong></td>
                        <td>West 8-11 mph</td>
                        <td>SW 3-7 mph</td>
                        <td>ENE 5-10 mph</td>
                        <td>SE 4-8 mph</td>
                        <td>S 6-12 mph</td>
                    </tr>
                    <tr>
                        <td><strong>Cloud Cover</strong></td>
                        <td>0% (Sunny)</td>
                        <td>20% (Mostly Sunny)</td>
                        <td>65% (Partly Cloudy)</td>
                        <td>30% (Mostly Sunny)</td>
                        <td>45% (Partly Cloudy)</td>
                    </tr>
                    <tr>
                        <td><strong>Precipitation Chance</strong></td>
                        <td>0%</td>
                        <td>10%</td>
                        <td>60%</td>
                        <td>20%</td>
                        <td>40%</td>
                    </tr>
                    <tr>
                        <td><strong>Precipitation Rate</strong></td>
                        <td>None</td>
                        <td>Light if any</td>
                        <td>Light to moderate</td>
                        <td>Light if any</td>
                        <td>Light</td>
                    </tr>
                </tbody>
            </table>

            <div style="background: linear-gradient(135deg, #fd79a8 0%, #e84393 100%); color: white; padding: 20px; border-radius: 15px; margin: 25px 0;">
                <h3>‚ö†Ô∏è Health & Safety Advisory</h3>
                <p>With heat index values reaching 107¬∞F, today poses significant health risks. Stay hydrated, limit outdoor activities during peak hours (10 AM - 6 PM), and check on elderly neighbors and pets. Heat exhaustion and heat stroke are serious concerns in these conditions.</p>
            </div>

            <div style="background: linear-gradient(135deg, #00b894 0%, #00cec9 100%); color: white; padding: 20px; border-radius: 15px; margin: 25px 0;">
                <h3>üå°Ô∏è Weather Pattern Analysis</h3>
                <p>This extreme heat event represents the peak of a significant heat dome over the region. Relief arrives Wednesday with a dramatic 13-degree drop in temperatures as a cooler air mass moves in from the north. Thursday brings the possibility of much-needed precipitation to end the heat spell.</p>
            </div>
        </div>

        <div class="footer">
            <p>Weather data compiled from National Weather Service Boston | Updated: June 24, 2025</p>
            <p>Stay safe and stay cool, Framingham! üå°Ô∏è‚ùÑÔ∏è</p>
        </div>
    </div>

    <script>
        // Display current timestamp when page loads
        function updateTimestamp() {
            const now = new Date();
            const options = {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                timeZone: 'America/New_York'
            };
            const timestamp = now.toLocaleDateString('en-US', options);
            document.getElementById('lastUpdated').textContent = timestamp + ' (EST)';
        }

        // Function to handle refresh button click
        function requestWeatherUpdate() {
            // Show loading state
            const refreshButton = document.querySelector('.refresh-button-compact');
            const originalText = refreshButton.innerHTML;
            refreshButton.innerHTML = '‚è≥ Refreshing...';
            refreshButton.disabled = true;
            refreshButton.style.opacity = '0.7';

            // Create a message to send to Claude
            const refreshMessage = "Please update the Framingham weather forecast with current data from the National Weather Service. Generate a fresh forecast with the latest conditions, alerts, and 3-day outlook.";
            
            // Create a modal to show the refresh is in progress and provide the message
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
                backdrop-filter: blur(5px);
            `;

            const modalContent = document.createElement('div');
            modalContent.style.cssText = `
                background: white;
                padding: 30px;
                border-radius: 20px;
                max-width: 600px;
                margin: 20px;
                text-align: center;
                box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
                animation: modalSlideIn 0.3s ease;
            `;

            modalContent.innerHTML = `
                <div style="margin-bottom: 20px;">
                    <div style="font-size: 3em; margin-bottom: 10px;">üîÑ</div>
                    <h2 style="color: #2d3436; margin-bottom: 15px;">Refreshing Weather Data</h2>
                </div>
                <p style="color: #636e72; margin-bottom: 20px; line-height: 1.6;">
                    Requesting fresh weather data from the National Weather Service...
                </p>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin: 15px 0; text-align: left; border-left: 4px solid #00b894;">
                    <strong>Auto-Request:</strong><br>
                    <em>"${refreshMessage}"</em>
                </div>
                <p style="color: #636e72; font-size: 0.9em; margin-bottom: 25px;">
                    Claude will now fetch the latest weather conditions and update this forecast automatically.
                </p>
                <div style="display: flex; gap: 10px; justify-content: center;">
                    <button onclick="executeRefresh()" style="
                        background: linear-gradient(135deg, #00b894 0%, #00cec9 100%);
                        color: white;
                        border: none;
                        padding: 12px 24px;
                        border-radius: 25px;
                        font-size: 1em;
                        font-weight: bold;
                        cursor: pointer;
                        transition: all 0.3s ease;
                    ">üöÄ Update Now</button>
                    <button onclick="closeModal()" style="
                        background: #6c757d;
                        color: white;
                        border: none;
                        padding: 12px 24px;
                        border-radius: 25px;
                        font-size: 1em;
                        font-weight: bold;
                        cursor: pointer;
                        transition: all 0.3s ease;
                    ">Cancel</button>
                </div>
            `;

            // Add animation keyframes
            const style = document.createElement('style');
            style.textContent = `
                @keyframes modalSlideIn {
                    from {
                        opacity: 0;
                        transform: translateY(-50px) scale(0.9);
                    }
                    to {
                        opacity: 1;
                        transform: translateY(0) scale(1);
                    }
                }
                @keyframes spin {
                    from { transform: rotate(0deg); }
                    to { transform: rotate(360deg); }
                }
            `;
            document.head.appendChild(style);

            modal.appendChild(modalContent);
            document.body.appendChild(modal);

            // Execute refresh function
            window.executeRefresh = function() {
                // Simulate the refresh by sending the message
                if (window.parent && window.parent.postMessage) {
                    window.parent.postMessage({
                        type: 'claude_request',
                        message: refreshMessage
                    }, '*');
                }
                
                // For standalone usage, copy message to clipboard
                if (navigator.clipboard) {
                    navigator.clipboard.writeText(refreshMessage).then(function() {
                        modalContent.innerHTML = `
                            <div style="margin-bottom: 20px;">
                                <div style="font-size: 3em; margin-bottom: 10px;">‚úÖ</div>
                                <h2 style="color: #00b894; margin-bottom: 15px;">Request Copied!</h2>
                            </div>
                            <p style="color: #636e72; margin-bottom: 20px; line-height: 1.6;">
                                The refresh request has been copied to your clipboard. 
                                Paste it into your chat with Claude to get updated weather data.
                            </p>
                            <button onclick="closeModal()" style="
                                background: linear-gradient(135deg, #00b894 0%, #00cec9 100%);
                                color: white;
                                border: none;
                                padding: 12px 24px;
                                border-radius: 25px;
                                font-size: 1em;
                                font-weight: bold;
                                cursor: pointer;
                                transition: all 0.3s ease;
                            ">Got it! üëç</button>
                        `;
                    });
                } else {
                    // Fallback for browsers without clipboard API
                    modalContent.innerHTML = `
                        <div style="margin-bottom: 20px;">
                            <div style="font-size: 3em; margin-bottom: 10px;">üìã</div>
                            <h2 style="color: #2d3436; margin-bottom: 15px;">Copy This Message</h2>
                        </div>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin: 15px 0; text-align: left; border: 2px solid #00b894; cursor: text;" onclick="selectText(this)">
                            ${refreshMessage}
                        </div>
                        <p style="color: #636e72; font-size: 0.9em; margin-bottom: 25px;">
                            Copy the message above and paste it into your chat with Claude to refresh the weather data.
                        </p>
                        <button onclick="closeModal()" style="
                            background: linear-gradient(135deg, #00b894 0%, #00cec9 100%);
                            color: white;
                            border: none;
                            padding: 12px 24px;
                            border-radius: 25px;
                            font-size: 1em;
                            font-weight: bold;
                            cursor: pointer;
                            transition: all 0.3s ease;
                        ">Done</button>
                    `;
                }
            };

            // Text selection helper
            window.selectText = function(element) {
                const range = document.createRange();
                range.selectNodeContents(element);
                const selection = window.getSelection();
                selection.removeAllRanges();
                selection.addRange(range);
            };

            // Close modal function
            window.closeModal = function() {
                document.body.removeChild(modal);
                document.head.removeChild(style);
                
                // Reset button
                refreshButton.innerHTML = originalText;
                refreshButton.disabled = false;
                refreshButton.style.opacity = '1';
                
                // Clean up global functions
                delete window.closeModal;
                delete window.executeRefresh;
                delete window.selectText;
            };

            // Close on background click
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    window.closeModal();
                }
            });
        }

        // Update timestamp when page loads
        
async function loadForecast() {
    const forecastGrid = document.querySelector('.forecast-grid');
    if (!forecastGrid) return;

    try {
        const pointResp = await fetch('https://api.weather.gov/points/42.3168,-71.429');
        const pointData = await pointResp.json();
        const forecastUrl = pointData.properties.forecast;

        const forecastResp = await fetch(forecastUrl);
        const forecastData = await forecastResp.json();

        const periods = forecastData.properties.periods
            .filter(p => p.isDaytime)
            .slice(0, 5); // 5 daytime forecasts only

        forecastGrid.innerHTML = ''; // Clear existing hardcoded HTML

        periods.forEach(period => {
            const card = document.createElement('div');
            card.className = 'day-card';
            card.innerHTML = `
                <h3>${period.name}</h3>
                <div class="temp-range">
                    High: <span class="temp-high">${period.temperature}¬∞F</span>
                </div>
                <p><strong>Conditions:</strong> ${period.shortForecast}</p>
                <p><strong>Wind:</strong> ${period.windDirection} ${period.windSpeed}</p>
                <p><strong>Precipitation:</strong> ${
                    period.probabilityOfPrecipitation?.value != null 
                        ? period.probabilityOfPrecipitation.value + '%' 
                        : 'N/A'
                }</p>
            `;
            forecastGrid.appendChild(card);
        });

    } catch (error) {
        console.error('Error fetching NWS forecast:', error);
        forecastGrid.innerHTML = '<p style="color: red;">‚ö†Ô∏è Failed to load live weather forecast.</p>';
    }
}




async function loadForecast() {
    const forecastGrid = document.querySelector('.forecast-grid');
    if (!forecastGrid) return;

    try {
        const pointResp = await fetch('https://api.weather.gov/points/42.3168,-71.429');
        const pointData = await pointResp.json();
        const forecastUrl = pointData.properties.forecast;

        const forecastResp = await fetch(forecastUrl);
        const forecastData = await forecastResp.json();

        const periods = forecastData.properties.periods
            .filter(p => p.isDaytime)
            .slice(0, 5); // 5 daytime forecasts only

        forecastGrid.innerHTML = ''; // Clear existing hardcoded HTML

        periods.forEach(period => {
            const card = document.createElement('div');
            card.className = 'day-card';
            card.innerHTML = `
                <h3>${period.name}</h3>
                <div class="temp-range">
                    High: <span class="temp-high">${period.temperature}¬∞F</span>
                </div>
                <p><strong>Conditions:</strong> ${period.shortForecast}</p>
                <p><strong>Wind:</strong> ${period.windDirection} ${period.windSpeed}</p>
                <p><strong>Precipitation:</strong> ${
                    period.probabilityOfPrecipitation?.value != null 
                        ? period.probabilityOfPrecipitation.value + '%' 
                        : 'N/A'
                }</p>
            `;
            forecastGrid.appendChild(card);
        });

    } catch (error) {
        console.error('Error fetching NWS forecast:', error);
        forecastGrid.innerHTML = '<p style="color: red;">‚ö†Ô∏è Failed to load live weather forecast.</p>';
    }
}



async function loadAFD() {
    try {
        const resp = await fetch("https://forecast.weather.gov/product.php?site=BOX&issuedby=BOX&product=AFD&format=CI&version=1&glossary=1&highlight=off");
        const text = await resp.text();

        const parser = new DOMParser();
        const doc = parser.parseFromString(text, "text/html");

        const pre = doc.querySelector("pre");
        const afdText = pre ? pre.textContent.trim().slice(0, 3000) + "..." : "AFD data not available.";

        const afdSection = document.createElement("div");
        afdSection.style.cssText = "background: linear-gradient(135deg, #fab1a0 0%, #ff7675 100%); color: white; padding: 20px; border-radius: 15px; margin: 25px 0;";
        afdSection.innerHTML = `
            <h3>üìù Area Forecast Discussion (NWS Boston)</h3>
            <pre style="white-space: pre-wrap; font-family: monospace;">${afdText}</pre>
        `;

        const content = document.querySelector(".content");
        if (content) content.appendChild(afdSection);
    } catch (error) {
        console.error("Error loading AFD:", error);
    }
}



async function loadForecastTable() {
    try {
        const pointResp = await fetch('https://api.weather.gov/points/42.3168,-71.429');
        const pointData = await pointResp.json();
        const forecastUrl = pointData.properties.forecast;

        const forecastResp = await fetch(forecastUrl);
        const forecastData = await forecastResp.json();
        const periods = forecastData.properties.periods;

        const table = document.querySelector(".weather-table tbody");
        if (!table) return;

        const headers = document.querySelectorAll(".weather-table thead th");
        const dayHeaders = Array.from(headers).slice(1); // skip "Weather Type" column
        const dayCount = dayHeaders.length;

        const dataByDay = Array(dayCount).fill(null);

        // Populate daytime forecast data for matching days
        let filled = 0;
        for (let i = 0; i < periods.length && filled < dayCount; i++) {
            if (periods[i].isDaytime) {
                dataByDay[filled] = periods[i];
                filled++;
            }
        }

        const rows = [
            ["High Temperature"],
            ["Low Temperature"],
            ["Real Feel (Heat Index)"],
            ["Dew Point"],
            ["Wind Speed"],
            ["Cloud Cover"],
            ["Precipitation Chance"],
            ["Precipitation Rate"]
        ];

        for (let i = 0; i < dayCount; i++) {
            const period = dataByDay[i];
            if (!period) continue;
            const temp = `${period.temperature}¬∞F`;
            const wind = `${period.windDirection} ${period.windSpeed}`;
            const precip = period.probabilityOfPrecipitation?.value != null ? period.probabilityOfPrecipitation.value + "%" : "N/A";
            const cloud = period.cloudCover?.value != null ? period.cloudCover.value + "%" : "N/A";

            rows[0].push(temp);
            rows[1].push("‚Äî");
            rows[2].push("‚Äî");
            rows[3].push("‚Äî");
            rows[4].push(wind);
            rows[5].push(cloud);
            rows[6].push(precip);
            rows[7].push("‚Äî");
        }

        table.innerHTML = "";
        for (const row of rows) {
            const tr = document.createElement("tr");
            for (let i = 0; i < row.length; i++) {
                const cell = document.createElement(i === 0 ? "td" : "td");
                if (i === 0) {
                    cell.innerHTML = `<strong>${row[i]}</strong>`;
                } else {
                    cell.textContent = row[i];
                }
                tr.appendChild(cell);
            }
            table.appendChild(tr);
        }

    } catch (err) {
        console.error("Error loading detailed table forecast:", err);
    }
}


document.addEventListener('DOMContentLoaded', () => {
    updateTimestamp();
    loadForecast();
    loadAFD();
    loadForecastTable();
});

    loadForecast();
});
    </script>
</body>
</html>